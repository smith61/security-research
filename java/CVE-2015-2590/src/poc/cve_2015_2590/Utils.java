package poc.cve_2015_2590;

public class Utils {
	
	public static long utfLength( CharSequence cs ) {
		long length = 0;
		for( int i = 0; i < cs.length(); i++ ) {
			char ch = cs.charAt( i );
			if( ch <= 0x7F ) {
				length += 1;
			}
			else if( ch <= 0x7FF ) {
				length += 2;
			}
			else if( Character.isHighSurrogate( ch ) ) {
				length += 4;
				i++;
			}
			else {
				length += 3;
			}
		}
		return length;
	}
	
}
